<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mario Carrion - Mono Accessibility 2.1</title><meta name=author content="Mario Carrion"><meta name=description content="The blog of Mario Carrion"><link rel=canonical href=http://www.mariocarrion.com/2010/08/26/mono-accessibility-2-1.html><link href="//fonts.googleapis.com/css?family=Inconsolata:400,700" rel=stylesheet><link rel="shortcut icon" href=/favicon.png><link rel=stylesheet href=/css/base.css><link rel=stylesheet href=/css/skeleton.css><link rel=stylesheet href=/css/screen.css><link rel=stylesheet href=/css/layout.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css><div class=container><div class="four columns sidebar"><nav><h1>Hello stranger!</h1><a href=/><img src=/images/logo.png id=logo alt="Blog logo" class=circular></a><h1>I&#39;m <a href=/about.html>Mario Carrion</a></h1><hr><ul id=blog-pages class=posts><li><span>&raquo; </span><a href=/about.html>About me</a><li><span>&raquo; </span><a href=/books.html>Books</a><li><span>&raquo; </span><a href=/disclaimer.html>Disclaimer</a><li><span>&raquo; </span><a href=https://docs.google.com/document/d/1i0W6qNfGMhTfwWTHBaaKzlN9HLGwbk3GLeh8VtVlhNM>Resume</a><li><span>&raquo; </span><a href=/archive.html#2010>All posts in 2010</a></ul><div id=social><div id=stalker><a href=https://github.com/MarioCarrion><i class="fa fa-github-square"></i></a><a href=http://stackoverflow.com/users/134327><i class="fa fa-stack-overflow"></i></a><a href=https://twitter.com/mariocarrion><i class="fa fa-twitter-square"></i></a><a href=https://www.linkedin.com/in/mariocarrion><i class="fa fa-linkedin-square"></i></a></div></div></nav></div><div class="eleven columns content"><p class=meta>Aug 26, 2010
<a href=/><i class="home fa fa-home"></i></a><h1 class=title>Mono Accessibility 2.1</h1><div id=post><p><a href=http://www.flickr.com/photos/mariocarrion/4886351160/ title="Candles by Mario Carrion, on Flickr"><img src=http://farm5.static.flickr.com/4136/4886351160_d6472b6aea_m.jpg alt=Candles></a><p>Last <a href=http://mono-project.com/Accessibility:_Release_Notes_2.1>Tuesday</a>, we presented <a href=http://mono-project.com/Accessibility>Mono Accessibility</a> 2.1. We worked really hard on this release. Our main goals were, among other things, to improve our <a href=http://msdn.microsoft.com/en-us/library/ms753107.aspx>UI Automation</a> Client API implementation, polish the interaction with at-spi2, better Moonlight accessibility and to handle custom and client-side providers. The great work made by all the contributors was the reason this release accomplished those goals.<h3 id=what-happened-since-last-time>What happened since last time?</h3><p>Explaining this release is kind of hard if you are not involved in Mono Accessibility, and even more difficult if you&rsquo;re not involved in Accessibility at all. However, if you&rsquo;re familiar with Mono and .NET you are, also, aware of the possibility of developing .NET-based applications that run on both platforms with minor* changes or no changes at all. But, before the implementation of Mono Accessibility, there was something missing: all those applications were not accessible.<p>This meant two things. First Atk-based Assistive Technologies (ATs) were not able to access Windows Forms nor Silverlight applications. Second .NET-based ATs using UI Automation were not able to run on Mono. Making them useless for people requiring Accessibility to interact with software running Mono on Linux**.<p>After the implementation of Mono Accessibility, we have:<ul><li>UI Automation API Framework<li>Bridge between UI Automation and ATK</ul><p>This way ATs using either Accessibility Technology, Atk or UI Automation, will be able to interact with Gtk+, Windows Forms and Silverlight applications, with no changes at all.<h3 id=this-is-what-happened>This is what happened</h3><p>In the following video: (if you are using a RSS reader click <a href="http://www.youtube.com/watch?v=NwMXYXGincE">this link</a>) <a href=http://live.gnome.org/Gcalctool>gcalctool</a> is launched and an application, using UI Automation Client API, interacts with it, clicking buttons &ldquo;2&rdquo;, &ldquo;+&rdquo;, &ldquo;3&rdquo; and &ldquo;=&rdquo;.<p>Then <a href=http://github.com/mattguo/UIAExplorer>UIA Explorer</a>, a .NET- based application using UI Automation Client API, also interacts with gcalctool, if you pay attention you will notice that UIA Explorer also lists all other Gtk+ based applications, such as Nautilus and the GNOME Panel.<p>Finally Mozilla Firefox is executed (both Novell Moonlight with Accessibility Support and Novell Moonlight Accessibility Extensions plugins were installed prior running it) and an Atk-based Accessility Debugger, <a href=http://live.gnome.org/Accerciser>Accerciser</a>, is launched to interact with the Moonlight application.<p><object width=425 height=330><param name=movie value="http://www.youtube.com/v/NwMXYXGincE?fs=1&amp;hl=en_US&amp;rel=0&amp;hd=1"></param><param name=allowFullScreen value=true></param><param name=allowscriptaccess value=always></param><embed src="http://www.youtube.com/v/NwMXYXGincE?fs=1&amp;hl=en_US&amp;rel=0&amp;hd=1" type=application/x-shockwave-flash allowscriptaccess=always allowfullscreen width=425 height=330></embed></object><p>The source code used to test GCalctool is the following:<div class=highlight style=background:#272822><pre style=line-height:125%><span></span><span style=color:#75715e>// gmcs -pkg:mono-uia gcalc.cs &amp;&amp; mono gcalc.exe</span>

<span style=color:#66d9ef>using</span> <span style=color:#f8f8f2>System;</span>
<span style=color:#66d9ef>using</span> <span style=color:#f8f8f2>System.Linq;</span>
<span style=color:#66d9ef>using</span> <span style=color:#f8f8f2>System.Windows.Automation;</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#f8f8f2>Mono.A11y.Examples</span> <span style=color:#f8f8f2>{</span>
	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GCalc</span> <span style=color:#f8f8f2>{</span>
		<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>Main</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>string</span> <span style=color:#f8f8f2>[]args)</span>
		<span style=color:#f8f8f2>{</span>
			<span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>cond</span>
				<span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
				                                            <span style=color:#f8f8f2>ControlType.Window),</span>
				                    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Calculator&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>gcalc</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>AutomationElement.RootElement.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Children,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#f8f8f2>cond</span> <span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
			                                                 <span style=color:#f8f8f2>ControlType.Button),</span>
			                         <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Add&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>addButton</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>gcalc.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Descendants,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#f8f8f2>cond</span> <span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
			                                                 <span style=color:#f8f8f2>ControlType.Button),</span>
			                         <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Numeric 2&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>Button2</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>gcalc.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Descendants,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#f8f8f2>cond</span> <span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
			                                                 <span style=color:#f8f8f2>ControlType.Button),</span>
			                         <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Numeric 3&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>Button3</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>gcalc.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Descendants,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#f8f8f2>cond</span> <span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
			                                                 <span style=color:#f8f8f2>ControlType.Button),</span>
			                         <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Calculate result&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>calcButton</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>gcalc.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Descendants,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#f8f8f2>cond</span> <span style=color:#f8f8f2>=</span> <span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>AndCondition</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>new</span> <span style=color:#f8f8f2>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.ControlTypeProperty,</span>
			                                                 <span style=color:#f8f8f2>ControlType.Button),</span>
			                         <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PropertyCondition</span> <span style=color:#f8f8f2>(AutomationElementIdentifiers.NameProperty,</span> <span style=color:#e6db74>&quot;Calculate result&quot;</span><span style=color:#f8f8f2>));</span>
			<span style=color:#66d9ef>var</span> <span style=color:#f8f8f2>resultText</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>gcalc.FindFirst</span> <span style=color:#f8f8f2>(TreeScope.Descendants,</span> <span style=color:#f8f8f2>cond);</span>

			<span style=color:#75715e>// Clicking buttons</span>
			<span style=color:#f8f8f2>InvokePattern</span> <span style=color:#f8f8f2>addInvoke</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>(InvokePattern)</span> <span style=color:#f8f8f2>addButton.GetCurrentPattern</span> <span style=color:#f8f8f2>(InvokePattern.Pattern);</span>
			<span style=color:#f8f8f2>InvokePattern</span> <span style=color:#f8f8f2>Invoke2</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>(InvokePattern)</span> <span style=color:#f8f8f2>Button2.GetCurrentPattern</span> <span style=color:#f8f8f2>(InvokePattern.Pattern);</span>
			<span style=color:#f8f8f2>InvokePattern</span> <span style=color:#f8f8f2>Invoke3</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>(InvokePattern)</span> <span style=color:#f8f8f2>Button3.GetCurrentPattern</span> <span style=color:#f8f8f2>(InvokePattern.Pattern);</span>
			<span style=color:#f8f8f2>InvokePattern</span> <span style=color:#f8f8f2>calcInvoke</span> <span style=color:#f8f8f2>=</span> <span style=color:#f8f8f2>(InvokePattern)</span> <span style=color:#f8f8f2>calcButton.GetCurrentPattern</span> <span style=color:#f8f8f2>(InvokePattern.Pattern);</span>

			<span style=color:#f8f8f2>System.Console.WriteLine</span> <span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Pressing \&quot;2\&quot;&quot;</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>System.Threading.Thread.Sleep</span> <span style=color:#f8f8f2>(</span><span style=color:#ae81ff>500</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>Invoke2.Invoke</span> <span style=color:#f8f8f2>();</span>

			<span style=color:#f8f8f2>System.Console.WriteLine</span> <span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Pressing \&quot;+\&quot;&quot;</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>System.Threading.Thread.Sleep</span> <span style=color:#f8f8f2>(</span><span style=color:#ae81ff>500</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>addInvoke.Invoke</span> <span style=color:#f8f8f2>();</span>

			<span style=color:#f8f8f2>System.Console.WriteLine</span> <span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Pressing \&quot;3\&quot;&quot;</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>System.Threading.Thread.Sleep</span> <span style=color:#f8f8f2>(</span><span style=color:#ae81ff>500</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>Invoke3.Invoke</span> <span style=color:#f8f8f2>();</span>

			<span style=color:#f8f8f2>System.Console.WriteLine</span> <span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Pressing \&quot;=\&quot;&quot;</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>System.Threading.Thread.Sleep</span> <span style=color:#f8f8f2>(</span><span style=color:#ae81ff>500</span><span style=color:#f8f8f2>);</span>
			<span style=color:#f8f8f2>calcInvoke.Invoke</span> <span style=color:#f8f8f2>();</span>
		<span style=color:#f8f8f2>}</span>
	<span style=color:#f8f8f2>}</span>
<span style=color:#f8f8f2>}</span>
</pre></div><h3 id=where-do-i-get-it>Where do I get it?</h3><p>If you installed <a href=2010/03/03/accessibility-in-moonlight/>Mono Accessibility 2.0</a> an option to upgrade should be available now, if not Mono Accessibility is available for a variety of Linux distributions, including:<ul><li>openSUSE 11.2 <a href=http://download.opensuse.org/repositories/Mono:/UIA/openSUSE_11.2/mono-uia.ymp>1-Click Install</a><li>Ubuntu Karmic Koala <a href=https://edge.launchpad.net/~mono-a11y/+archive/releases>Package Archive on Launchpad</a><li>Fedora 12 <a href="http://download.opensuse.org/repositories/Mono:/UIA/Fedora_12/ Repository">openSUSE Build Service<a></a></ul><p>Moonlight applications require the following extra steps:<ul><li>Install the updated <em>xulrunner</em> package from the above repositories. _(Required until patch on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=480317">bug #480317</a>) gets approved._<li>Install Novell Moonlight with Accessibility Support for <a href=http://www.mono-a11y.org/archive/moonlight-plugins/2.3.99.0accessibility/novell-moonlight-2.3.99.0accessibility-i586.xpi>32 bit</a> or <a href=http://www.mono-a11y.org/archive/moonlight-plugins/2.3.99.0accessibility/novell-moonlight-2.3.99.0accessibility-x86_64.xpi>64 bit</a>.<li>Install <a href=http://www.mono-a11y.org/archive/moonlight-a11y-plugins/2.1/novell-moonlight-a11y-2.1-noarch.xpi>Novell Moonlight Accessibility Extensions</a></ul><p>Have fun and if you find any bug with this release, please <a href="https://bugzilla.novell.com/enter_bug.cgi?product=UI%20Automation file bugs">file it</a>. If you want to contribute or need specific assistance, please join our <a href=http://forge.novell.com/mailman/listinfo/mono-a11y>mailing list</a>, or drop in <a href=irc://irc.gimp.org/mono-a11y>#mono-a11y</a> on irc.gimp.org.<ul><li><em>Of course this depends on what APIs you are using. If you want to know how compatible is your application try <a href=http://www.mono-project.com/MoMA>MoMA</a>.</em></ul><p>** <em>Notice however, even though Mono is muti platform and UI Automation is included in both Mono and Silverlight, in order to allow other ATs running on other platforms, different than Linux, you will require to implement an specific bridge to talk to you OS Accessibility Layer.</em></div><div id=related><h3>Posts</h3><ul class=posts><li><span>All in 2016!</span> <a href=/archive.html#2010>All posts from this year</a></ul><ul class=posts><li><span>Jun 22, 2010</span> <a href=http://www.mariocarrion.com/2010/06/22/hackweek-v-yastroid.html>Hackweek V: YaSTroid</a><li><span>Jan 12, 2011</span> <a href=http://www.mariocarrion.com/2011/01/12/die-bug.html>Die bug!</a></ul></div><div class=footer><div class=disclaimer><p>The postings on this site are my own and do not represent my
<a href=http://www.meredith.com/>employer's</a> positions, strategies or opinions.<p>&copy; Mario Carrion, 2004-2016 &mdash; built with <a href=https://gohugo.io/>Hugo</a> using a heavily modified version of <a href=https://github.com/swanson/lagom>Lagom theme</a></div></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-75640250-1','auto');ga('send','pageview');</script>