<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mario Carrion - Die bug!</title><meta name=author content="Mario Carrion"><meta name=description content="The blog of Mario Carrion"><link rel=canonical href=http://www.mariocarrion.com/2011/01/12/die-bug.html><link href="//fonts.googleapis.com/css?family=Inconsolata:400,700" rel=stylesheet><link rel="shortcut icon" href=/favicon.png><link rel=stylesheet href=/css/base.css><link rel=stylesheet href=/css/skeleton.css><link rel=stylesheet href=/css/screen.css><link rel=stylesheet href=/css/layout.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css><div class=container><div class="four columns sidebar"><nav><h1>Hello stranger!</h1><a href=/><img src=/images/logo.png id=logo alt="Blog logo" class=circular></a><h1>I&#39;m <a href=/about.html>Mario Carrion</a></h1><hr><ul id=blog-pages class=posts><li><span>&raquo; </span><a href=/about.html>About me</a><li><span>&raquo; </span><a href=/books.html>Books</a><li><span>&raquo; </span><a href=/disclaimer.html>Disclaimer</a><li><span>&raquo; </span><a href=https://docs.google.com/document/d/1i0W6qNfGMhTfwWTHBaaKzlN9HLGwbk3GLeh8VtVlhNM>Resume</a><li><span>&raquo; </span><a href=/archive.html#2011>All posts in 2011</a></ul><div id=social><div id=stalker><a href=https://github.com/MarioCarrion><i class="fa fa-github-square"></i></a><a href=http://stackoverflow.com/users/134327><i class="fa fa-stack-overflow"></i></a><a href=https://twitter.com/mariocarrion><i class="fa fa-twitter-square"></i></a><a href=https://www.linkedin.com/in/mariocarrion><i class="fa fa-linkedin-square"></i></a></div></div></nav></div><div class="eleven columns content"><p class=meta>Jan 12, 2011
<a href=/><i class="home fa fa-home"></i></a><h1 class=title>Die bug!</h1><div id=post><p><p><a href=http://www.flickr.com/photos/mariocarrion/5349091765/ title="Dead fly by Mario Carrion, on Flickr"><img src=http://farm6.static.flickr.com/5208/5349091765_7618eedc5b_m.jpg width=240 height=160 alt="Dead fly" class=aligncenter></a><p>Every once in a while I have to fix a bug that really drives me crazy. When this happens I usually recall one morning in the Computer Lab, back in college, one of my professors saying: &ldquo;It doesn&rsquo;t matter what you do, it doesn&rsquo;t matter if you get upset or mad. You won&rsquo;t beat the computer&rdquo;. That morning I didn&rsquo;t understand what he was trying to say. Actually I thought he was making fun of us. Foolish Mario, he wasn&rsquo;t trying to do that. He was trying to advice us: to always stay calm.<p>Software Development could be stressful sometimes, if you write software you already know that. Even if you are an experienced programmer knowing the tools and loving writing software you will eventually face a situation, usually fixing a bug, that will drive you crazy and this gets worse when time is constrained, which usually is. At that time is when you have to breath deeply and evaluate every single piece of the puzzle. That&rsquo;s when you begin enjoying the situation.<p>Software programmers like to fix, create and understand stuff, specially people with technical background, like me. We are also kind of masochists and we never give up. In my case I like saving those tips because I&rsquo;m certain that I will need that information in the future.<p>The following is a list of tips that I wanted to share (<strong>and save!</strong>) and might be useful when debugging and/or writing software on Linux. Almost all tips are for debugging shared libraries however most of them will work for anything else besides shared libraries. There might be similar alternatives for the other OSs, I&rsquo;m not sure though.<h3>LD_DEBUG</h3><p>If you write shared libraries or if have built any package from source you might be familiar with LD_LIBRARY_PATH, an environment variable meant to be used for specifying directories where to search libraries first, recommended for <i>development and testing</i>, nothing else. Well there&rsquo;s another environment variable called <i>LD_DEBUG</i>, really useful for debugging. It basically outputs all dl* function calls. Use <i>LD_DEBUG=help command</i> for help.<h3>nm and objdump</h3><p>GNU Binutils is fascinating and has several utilities, however most of the time you will use only those two commands. Reading the manual is the best way to understand them. Basically they help you by listing the symbols used and exported in object files. I&rsquo;ve used this two commands to make sure the final file, after linking, doesn&rsquo;t reference to any other library I don&rsquo;t need, and to make sure my shared libraries export the functions that were meant to export.<h3>stop-on-solib-events</h3><p>One of the hidden gems of gdb. Setting <a href=http://sourceware.org/gdb/download/onlinedocs/gdb/Files.html#Files>stop-on-solib-events</a> to 1 will allow you to pause the execution of your program when a shared library is loaded. Really useful to know <i>why is my shared library loaded twice?</i> or <i>who is loading what library?</i>. See the other commands to specify files.<h3>ldd and pmap</h3><p>These are quite similar, both somehow tell you dependencies. The main difference is that <i>ldd</i> shows what libraries are required and <i>pmap</i> shows you process memory mapping, this means memory used and what libraries are actually used for the program.<h3>strace</h3><p>Traces all calls and signals used by the program. Using -e to define expressions is required unless you want to see lines and lines of calls. It could be useful if you want to profile you program.<h3>valgrind</h3><p>Required for profiling. In my previous job I used a lot since all applications were running 24x7 and memory was one of the most important things. I usually leave the application running for days using the following arguments: <i>&ndash;leak-check=full &ndash;leak-resolution=high &ndash;show-reachable=yes</i> then I comeback <i>ctrl+c</i> and I see the results.<h3>Something else?</h3><p>I&rsquo;m sure I&rsquo;m missing more commands, some of them language/platform-specific however I&rsquo;m also sure this list will help me recalling what to check first when debugging shared libraries.<h3>References</h3><ul><li><a href=http://tldp.org/HOWTO/Program-Library-HOWTO/index.html>Programming Howto</a><li><a href=http://www.gnu.org/software/binutils/>Binutils</a><li><a href=http://sourceware.org/gdb/download/onlinedocs/gdb/index.html>Debugging with gdb</a><li><a href=http://www.network-theory.co.uk/docs/valgrind/>Valgrind 3.3 - Advanced Debugging and Profiling</a>, you can buy the book on <a href="http://www.amazon.com/Valgrind-3-3-Debugging-Profiling-applications/dp/0954612051/ref=sr_1_1?ie=UTF8&qid=1294854842&sr=8-1">Amazon</a> too.</ul></div><div id=related><h3>Posts</h3><ul class=posts><li><span>All in 2016!</span> <a href=/archive.html#2011>All posts from this year</a></ul><ul class=posts><li><span>Aug 26, 2010</span> <a href=http://www.mariocarrion.com/2010/08/26/mono-accessibility-2-1.html>Mono Accessibility 2.1</a><li><span>Mar 01, 2011</span> <a href=http://www.mariocarrion.com/2011/03/01/clickjacking-and-facebook.html>Clickjacking and Facebook</a></ul></div><div class=footer><div class=disclaimer><p>The postings on this site are my own and do not represent my
<a href=http://www.meredith.com/>employer's</a> positions, strategies or opinions.<p>&copy; Mario Carrion, 2004-2016 &mdash; built with <a href=https://gohugo.io/>Hugo</a> using a heavily modified version of <a href=https://github.com/swanson/lagom>Lagom theme</a></div></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-75640250-1','auto');ga('send','pageview');</script>